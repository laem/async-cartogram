!function(n,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):"object"==typeof exports?exports.AsyncCartogram=t():n.AsyncCartogram=t()}(this,function(){return function(n){function t(i){if(r[i])return r[i].exports;var o=r[i]={exports:{},id:i,loaded:!1};return n[i].call(o.exports,o,o.exports,t),o.loaded=!0,o.exports}var r={};return t.m=n,t.c=r,t.p="",t(0)}([function(n,t,r){function i(){var n;return new(n=r("undefined"!=typeof window?1:3))}function o(n,t,r){function o(i,o){i.postMessage({"do":"carto",geo:n,values:t[o],featureProperty:r,task:o})}function a(n,t){n.onmessage=function(t){var r=t;if("undefined"!=typeof t.data&&(r=t.data),"processing"===r.done){if(u.notify(Object.keys(s).length/l),s[r.task]=r,Object.keys(s).length===l)return u.resolve(s),void f.forEach(function(n){n.terminate()});if(c.length>0){var i=c.pop();o(n,i)}}},o(n,t)}for(var u=new e.Deferred,c=Object.keys(t),l=c.length,f=[],s={};f.length<9&&c.length>0;){var p=i();f.push(p),a(p,c.pop())}return u}var e=r(6);n.exports=o},function(n,t,r){n.exports=function(){return r(2)('!function(n){function t(i){if(r[i])return r[i].exports;var o=r[i]={exports:{},id:i,loaded:!1};return n[i].call(o.exports,o,o.exports,t),o.loaded=!0,o.exports}var r={};return t.m=n,t.c=r,t.p="",t(0)}([function(n,t,r){function i(){}function o(n){function t(n){return h[n.properties[g]]}var r=n;if("undefined"!=typeof n.data&&(r=n.data),"carto"===r["do"]){var i=r.geo,o=i.topology,u=i.geometries,c=i.path,l=i.translation,f=i.projection.name,s=i.projection.scaling,p=i.projection.center,l=i.projection.translation,h=r.values,g=r.featureProperty,v=r.task;o=a.copy(o);var d=e.geo[f]().scale(s);null!=p&&d.center(p),null!=l&&d.translate(l);for(var M,y,E,m,S,x=a.transformer(o.transform),N=o.arcs.length,b=0,q=new Array(N);N>b;){for(M=0,y=0,E=o.arcs[b].length,m=0,S=new Array(E);E>m;)o.arcs[b][m][0]=M+=o.arcs[b][m][0],o.arcs[b][m][1]=y+=o.arcs[b][m][1],S[m]=d(x(o.arcs[b][m])),m++;q[b++]=S}for(var c=e.geo.path().projection(null),w=a.object(q,{type:"GeometryCollection",geometries:u}).geometries.map(function(n){return{type:"Feature",id:n.id,properties:a.properties.call(null,n,o),geometry:n}}),P=w.map(t),j=P.reduce(function(n,t){return n+t}),A=8,z=0;z++<A;){for(var I=[],R=0,L=0;L<w.length;L++){var O=c.area(w[L]);I.push(O),R+=O}for(var k=0,C=0,F=[],G=0;G<w.length;G++){var T=w[G],O=Math.abs(I[G]),U=+P[G],Z=R*U/j,B=Math.sqrt(O/Math.PI),D=Math.sqrt(Z/Math.PI)-B,H=Math.max(O,Z)/Math.min(O,Z);k+=H,C++,F.push({id:T.id,area:O,centroid:c.centroid(T),value:U,desired:Z,range:100*Math.abs(Z-O)/Math.sqrt(Math.PI*O),radius:B,mass:D,sizeError:H})}for(var E,m,J,J,K,Q,V,D,B,W,X,Y,$,_,nn,H=k/C,tn=1/(1+H),N=q.length,b=0;N>b;){for(E=q[b].length,m=0;E>m;){for(J=[0,0],K=F.length,Q=0;K>Q;){if(V=F[Q].centroid,D=F[Q].mass,B=F[Q].radius,W=B*B,X=q[b][m][0]-V[0],Y=q[b][m][1]-V[1],$=X*X+Y*Y,_=Math.sqrt($),_<F[Q].range){nn=_>B?D*B/_:D*($/W)*(4-3*_/B);var rn=a.arctans(Y,X);J[0]+=nn*rn.cos,J[1]+=nn*rn.sin}Q++}q[b][m][0]+=J[0]*tn,q[b][m][1]+=J[1]*tn,m++}b++}if(1>=H)break}var on={done:"processing",features:w,task:v};"undefined"!=typeof self?self.postMessage(on):this.onmessage(on)}}var e=r(1),a=r(2);"undefined"!=typeof onmessage?onmessage=o:(i.prototype.postMessage=o,i.prototype.terminate=function(){},n.exports=i)},function(n,t,r){var i,o;!function(){function e(n){return n}function a(n,t,r){return(t[0]-n[0])*(r[1]-n[1])-(t[1]-n[1])*(r[0]-n[0])}function u(n){return n>1?0:-1>n?bn:Math.acos(n)}function c(n){return n>1?wn:-1>n?-wn:Math.asin(n)}function l(n,t,r){return function(){var i=r.apply(t,arguments);return i===t?n:i}}function f(){return!0}function s(){}function p(n){return[Math.atan2(n[1],n[0]),c(n[2])]}function h(n,t){return An(n[0]-t[0])<xn&&An(n[1]-t[1])<xn}function g(n,t,r,i,o){var e=[],a=[];if(n.forEach(function(n){if(!((t=n.length-1)<=0)){var t,r=n[0],i=n[t];if(h(r,i)){o.lineStart();for(var u=0;t>u;++u)o.point((r=n[u])[0],r[1]);return void o.lineEnd()}var c=new d(r,n,null,!0),l=new d(r,null,c,!1);c.o=l,e.push(c),a.push(l),c=new d(i,n,null,!1),l=new d(i,null,c,!0),c.o=l,e.push(c),a.push(l)}}),a.sort(t),v(e),v(a),e.length){for(var u=0,c=r,l=a.length;l>u;++u)a[u].e=c=!c;for(var f,s,p=e[0];;){for(var g=p,M=!0;g.v;)if((g=g.n)===p)return;f=g.z,o.lineStart();do{if(g.v=g.o.v=!0,g.e){if(M)for(var u=0,l=f.length;l>u;++u)o.point((s=f[u])[0],s[1]);else i(g.x,g.n.x,1,o);g=g.n}else{if(M){f=g.p.z;for(var u=f.length-1;u>=0;--u)o.point((s=f[u])[0],s[1])}else i(g.x,g.p.x,-1,o);g=g.p}g=g.o,f=g.z,M=!M}while(!g.v);o.lineEnd()}}}function v(n){if(t=n.length){for(var t,r,i=0,o=n[0];++i<t;)o.n=r=n[i],r.p=o,o=r;o.n=r=n[0],r.p=o}}function d(n,t,r,i){this.x=n,this.z=t,this.o=r,this.e=i,this.v=!1,this.n=this.p=null}function M(n,t,r,i){return function(o,e){function a(t,r){var i=o(t,r);n(t=i[0],r=i[1])&&e.point(t,r)}function u(n,t){var r=o(n,t);M.point(r[0],r[1])}function c(){x.point=u,M.lineStart()}function l(){x.point=a,M.lineEnd()}function f(n,t){d.push([n,t]);var r=o(n,t);b.point(r[0],r[1])}function s(){b.lineStart(),d=[]}function p(){f(d[0][0],d[0][1]),b.lineEnd();var n,t=b.clean(),r=N.buffer(),i=r.length;if(d.pop(),v.push(d),d=null,i)if(1&t){n=r[0];var o,i=n.length-1,a=-1;if(i>0){for(q||(e.polygonStart(),q=!0),e.lineStart();++a<i;)e.point((o=n[a])[0],o[1]);e.lineEnd()}}else i>1&&2&t&&r.push(r.pop().concat(r.shift())),h.push(r.filter(y))}var h,v,d,M=t(e),S=o.invert(i[0],i[1]),x={point:a,lineStart:c,lineEnd:l,polygonStart:function(){x.point=f,x.lineStart=s,x.lineEnd=p,h=[],v=[]},polygonEnd:function(){x.point=a,x.lineStart=c,x.lineEnd=l,h=Sn.merge(h);var n=J(S,v);h.length?(q||(e.polygonStart(),q=!0),g(h,m,n,r,e)):n&&(q||(e.polygonStart(),q=!0),e.lineStart(),r(null,null,1,e),e.lineEnd()),q&&(e.polygonEnd(),q=!1),h=v=null},sphere:function(){e.polygonStart(),e.lineStart(),r(null,null,1,e),e.lineEnd(),e.polygonEnd()}},N=E(),b=t(N),q=!1;return x}}function y(n){return n.length>1}function E(){var n,t=[];return{lineStart:function(){t.push(n=[])},point:function(t,r){n.push([t,r])},lineEnd:s,buffer:function(){var r=t;return t=[],n=null,r},rejoin:function(){t.length>1&&t.push(t.pop().concat(t.shift()))}}}function m(n,t){return((n=n.x)[0]<0?n[1]-wn-xn:wn-n[1])-((t=t.x)[0]<0?t[1]-wn-xn:wn-t[1])}function S(n){var t,r=NaN,i=NaN,o=NaN;return{lineStart:function(){n.lineStart(),t=1},point:function(e,a){var u=e>0?bn:-bn,c=An(e-r);An(c-bn)<xn?(n.point(r,i=(i+a)/2>0?wn:-wn),n.point(o,i),n.lineEnd(),n.lineStart(),n.point(u,i),n.point(e,i),t=0):o!==u&&c>=bn&&(An(r-o)<xn&&(r-=o*xn),An(e-u)<xn&&(e-=u*xn),i=x(r,i,e,a),n.point(o,i),n.lineEnd(),n.lineStart(),n.point(u,i),t=0),n.point(r=e,i=a),o=u},lineEnd:function(){n.lineEnd(),r=i=NaN},clean:function(){return 2-t}}}function x(n,t,r,i){var o,e,a=Math.sin(n-r);return An(a)>xn?Math.atan((Math.sin(t)*(e=Math.cos(i))*Math.sin(r)-Math.sin(i)*(o=Math.cos(t))*Math.sin(n))/(o*e*a)):(t+i)/2}function N(n,t,r,i){var o;if(null==n)o=r*wn,i.point(-bn,o),i.point(0,o),i.point(bn,o),i.point(bn,0),i.point(bn,-o),i.point(0,-o),i.point(-bn,-o),i.point(-bn,0),i.point(-bn,o);else if(An(n[0]-t[0])>xn){var e=n[0]<t[0]?bn:-bn;o=r*e/2,i.point(-e,o),i.point(0,o),i.point(e,o)}else i.point(t[0],t[1])}function b(n){var t=n[0],r=n[1],i=Math.cos(r);return[i*Math.cos(t),i*Math.sin(t),Math.sin(r)]}function q(n,t){return n[0]*t[0]+n[1]*t[1]+n[2]*t[2]}function w(n,t){return[n[1]*t[2]-n[2]*t[1],n[2]*t[0]-n[0]*t[2],n[0]*t[1]-n[1]*t[0]]}function P(n,t){n[0]+=t[0],n[1]+=t[1],n[2]+=t[2]}function j(n,t){return[n[0]*t,n[1]*t,n[2]*t]}function A(n){var t=Math.sqrt(n[0]*n[0]+n[1]*n[1]+n[2]*n[2]);n[0]/=t,n[1]/=t,n[2]/=t}function z(n,t){function r(r,i){return r=n(r,i),t(r[0],r[1])}return n.invert&&t.invert&&(r.invert=function(r,i){return r=t.invert(r,i),r&&n.invert(r[0],r[1])}),r}function I(n,t){return[n,t]}function R(n,t){return[n>bn?n-qn:-bn>n?n+qn:n,t]}function L(n,t,r){return n?t||r?z(k(n),C(t,r)):k(n):t||r?C(t,r):R}function O(n){return function(t,r){return t+=n,[t>bn?t-qn:-bn>t?t+qn:t,r]}}function k(n){var t=O(n);return t.invert=O(-n),t}function C(n,t){function r(n,t){var r=Math.cos(t),u=Math.cos(n)*r,l=Math.sin(n)*r,f=Math.sin(t),s=f*i+u*o;return[Math.atan2(l*e-s*a,u*i-f*o),c(s*e+l*a)]}var i=Math.cos(n),o=Math.sin(n),e=Math.cos(t),a=Math.sin(t);return r.invert=function(n,t){var r=Math.cos(t),u=Math.cos(n)*r,l=Math.sin(n)*r,f=Math.sin(t),s=f*e-l*a;return[Math.atan2(l*e+f*a,u*i+s*o),c(s*i-u*o)]},r}function F(n,t){var r=Math.cos(n),i=Math.sin(n);return function(o,e,a,u){var c=a*t;null!=o?(o=G(r,o),e=G(r,e),(a>0?e>o:o>e)&&(o+=a*qn)):(o=n+a*qn,e=n-.5*c);for(var l,f=o;a>0?f>e:e>f;f-=c)u.point((l=p([r,-i*Math.cos(f),-i*Math.sin(f)]))[0],l[1])}}function G(n,t){var r=b(t);r[0]-=n,A(r);var i=u(-r[1]);return((-r[2]<0?-i:i)+2*Math.PI-xn)%(2*Math.PI)}function T(){}function U(n,t,r){var i=r.s=n+t,o=i-n,e=i-o;r.t=n-e+(t-o)}function Z(n,t){n&&Ln.hasOwnProperty(n.type)&&Ln[n.type](n,t)}function B(n,t,r){var i,o=-1,e=n.length-r;for(t.lineStart();++o<e;)i=n[o],t.point(i[0],i[1],i[2]);t.lineEnd()}function D(n,t){var r=-1,i=n.length;for(t.polygonStart();++r<i;)B(n[r],t,1);t.polygonEnd()}function H(){function n(n,t){n*=Pn,t=t*Pn/2+bn/4;var r=n-i,a=r>=0?1:-1,u=a*r,c=Math.cos(t),l=Math.sin(t),f=e*l,s=o*c+f*Math.cos(u),p=f*a*Math.sin(u);kn.add(Math.atan2(p,s)),i=n,o=c,e=l}var t,r,i,o,e;Cn.point=function(a,u){Cn.point=n,i=(t=a)*Pn,o=Math.cos(u=(r=u)*Pn/2+bn/4),e=Math.sin(u)},Cn.lineEnd=function(){n(t,r)}}function J(n,t){var r=n[0],i=n[1],o=[Math.sin(r),-Math.cos(r),0],e=0,a=0;kn.reset();for(var u=0,l=t.length;l>u;++u){var f=t[u],s=f.length;if(s)for(var p=f[0],h=p[0],g=p[1]/2+bn/4,v=Math.sin(g),d=Math.cos(g),M=1;;){M===s&&(M=0),n=f[M];var y=n[0],E=n[1]/2+bn/4,m=Math.sin(E),S=Math.cos(E),x=y-h,N=x>=0?1:-1,q=N*x,P=q>bn,j=v*m;if(kn.add(Math.atan2(j*N*Math.sin(q),d*S+j*Math.cos(q))),e+=P?x+N*qn:x,P^h>=r^y>=r){var z=w(b(p),b(n));A(z);var I=w(o,z);A(I);var R=(P^x>=0?-1:1)*c(I[2]);(i>R||i===R&&(z[0]||z[1]))&&(a+=P^x>=0?1:-1)}if(!M++)break;h=y,v=m,d=S,p=n}}return(-xn>e||xn>e&&0>kn)^1&a}function K(n){function t(n,t){return Math.cos(n)*Math.cos(t)>e}function r(n){var r,e,c,l,f;return{lineStart:function(){l=c=!1,f=1},point:function(s,p){var g,v=[s,p],d=t(s,p),M=a?d?0:o(s,p):d?o(s+(0>s?bn:-bn),p):0;if(!r&&(l=c=d)&&n.lineStart(),d!==c&&(g=i(r,v),(h(r,g)||h(v,g))&&(v[0]+=xn,v[1]+=xn,d=t(v[0],v[1]))),d!==c)f=0,d?(n.lineStart(),g=i(v,r),n.point(g[0],g[1])):(g=i(r,v),n.point(g[0],g[1]),n.lineEnd()),r=g;else if(u&&r&&a^d){var y;M&e||!(y=i(v,r,!0))||(f=0,a?(n.lineStart(),n.point(y[0][0],y[0][1]),n.point(y[1][0],y[1][1]),n.lineEnd()):(n.point(y[1][0],y[1][1]),n.lineEnd(),n.lineStart(),n.point(y[0][0],y[0][1])))}!d||r&&h(r,v)||n.point(v[0],v[1]),r=v,c=d,e=M},lineEnd:function(){c&&n.lineEnd(),r=null},clean:function(){return f|(l&&c)<<1}}}function i(n,t,r){var i=b(n),o=b(t),a=[1,0,0],u=w(i,o),c=q(u,u),l=u[0],f=c-l*l;if(!f)return!r&&n;var s=e*c/f,h=-e*l/f,g=w(a,u),v=j(a,s),d=j(u,h);P(v,d);var M=g,y=q(v,M),E=q(M,M),m=y*y-E*(q(v,v)-1);if(!(0>m)){var S=Math.sqrt(m),x=j(M,(-y-S)/E);if(P(x,v),x=p(x),!r)return x;var N,A=n[0],z=t[0],I=n[1],R=t[1];A>z&&(N=A,A=z,z=N);var L=z-A,O=An(L-bn)<xn,k=O||xn>L;if(!O&&I>R&&(N=I,I=R,R=N),k?O?I+R>0^x[1]<(An(x[0]-A)<xn?I:R):I<=x[1]&&x[1]<=R:L>bn^(A<=x[0]&&x[0]<=z)){var C=j(M,(-y+S)/E);return P(C,v),[x,p(C)]}}}function o(t,r){var i=a?n:bn-n,o=0;return-i>t?o|=1:t>i&&(o|=2),-i>r?o|=4:r>i&&(o|=8),o}var e=Math.cos(n),a=e>0,u=An(e)>xn,c=F(n,6*Pn);return M(t,r,c,a?[0,-n]:[-bn,n-bn])}function Q(n,t,r,i){return function(o){var e,a=o.a,u=o.b,c=a.x,l=a.y,f=u.x,s=u.y,p=0,h=1,g=f-c,v=s-l;if(e=n-c,g||!(e>0)){if(e/=g,0>g){if(p>e)return;h>e&&(h=e)}else if(g>0){if(e>h)return;e>p&&(p=e)}if(e=r-c,g||!(0>e)){if(e/=g,0>g){if(e>h)return;e>p&&(p=e)}else if(g>0){if(p>e)return;h>e&&(h=e)}if(e=t-l,v||!(e>0)){if(e/=v,0>v){if(p>e)return;h>e&&(h=e)}else if(v>0){if(e>h)return;e>p&&(p=e)}if(e=i-l,v||!(0>e)){if(e/=v,0>v){if(e>h)return;e>p&&(p=e)}else if(v>0){if(p>e)return;h>e&&(h=e)}return p>0&&(o.a={x:c+p*g,y:l+p*v}),1>h&&(o.b={x:c+h*g,y:l+h*v}),o}}}}}}function V(n,t,r,i){function o(i,o){return An(i[0]-n)<xn?o>0?0:3:An(i[0]-r)<xn?o>0?2:1:An(i[1]-t)<xn?o>0?1:0:o>0?3:2}function e(n,t){return u(n.x,t.x)}function u(n,t){var r=o(n,1),i=o(t,1);return r!==i?r-i:0===r?t[1]-n[1]:1===r?n[0]-t[0]:2===r?n[1]-t[1]:t[0]-n[0]}return function(c){function l(n){for(var t=0,r=y.length,i=n[1],o=0;r>o;++o)for(var e,u=1,c=y[o],l=c.length,f=c[0];l>u;++u)e=c[u],f[1]<=i?e[1]>i&&a(f,e,n)>0&&++t:e[1]<=i&&a(f,e,n)<0&&--t,f=e;return 0!==t}function f(e,a,c,l){var f=0,s=0;if(null==e||(f=o(e,c))!==(s=o(a,c))||u(e,a)<0^c>0){do l.point(0===f||3===f?n:r,f>1?i:t);while((f=(f+c+4)%4)!==s)}else l.point(a[0],a[1])}function s(o,e){return o>=n&&r>=o&&e>=t&&i>=e}function p(n,t){s(n,t)&&c.point(n,t)}function h(){R.point=d,y&&y.push(m=[]),P=!0,w=!1,b=q=NaN}function v(){M&&(d(S,x),N&&w&&z.rejoin(),M.push(z.buffer())),R.point=p,w&&c.lineEnd()}function d(n,t){n=Math.max(-Fn,Math.min(Fn,n)),t=Math.max(-Fn,Math.min(Fn,t));var r=s(n,t);if(y&&m.push([n,t]),P)S=n,x=t,N=r,P=!1,r&&(c.lineStart(),c.point(n,t));else if(r&&w)c.point(n,t);else{var i={a:{x:b,y:q},b:{x:n,y:t}};I(i)?(w||(c.lineStart(),c.point(i.a.x,i.a.y)),c.point(i.b.x,i.b.y),r||c.lineEnd(),j=!1):r&&(c.lineStart(),c.point(n,t),j=!1)}b=n,q=t,w=r}var M,y,m,S,x,N,b,q,w,P,j,A=c,z=E(),I=Q(n,t,r,i),R={point:p,lineStart:h,lineEnd:v,polygonStart:function(){c=z,M=[],y=[],j=!0},polygonEnd:function(){c=A,M=Sn.merge(M);var t=l([n,i]),r=j&&t,o=M.length;(r||o)&&(c.polygonStart(),r&&(c.lineStart(),f(null,null,1,c),c.lineEnd()),o&&g(M,e,t,f,c),c.polygonEnd()),M=y=m=null}};return R}}function W(n){function t(n){return(u?i:r)(n)}function r(t){return Y(t,function(r,i){r=n(r,i),t.point(r[0],r[1])})}function i(t){function r(r,i){r=n(r,i),t.point(r[0],r[1])}function i(){E=NaN,q.point=e,t.lineStart()}function e(r,i){var e=b([r,i]),a=n(r,i);o(E,m,y,S,x,N,E=a[0],m=a[1],y=r,S=e[0],x=e[1],N=e[2],u,t),t.point(E,m)}function a(){q.point=r,t.lineEnd()}function c(){i(),q.point=l,q.lineEnd=f}function l(n,t){e(s=n,p=t),h=E,g=m,v=S,d=x,M=N,q.point=e}function f(){o(E,m,y,S,x,N,h,g,s,v,d,M,u,t),q.lineEnd=a,a()}var s,p,h,g,v,d,M,y,E,m,S,x,N,q={point:r,lineStart:i,lineEnd:a,polygonStart:function(){t.polygonStart(),q.lineStart=c},polygonEnd:function(){t.polygonEnd(),q.lineStart=i}};return q}function o(t,r,i,u,c,l,f,s,p,h,g,v,d,M){var y=f-t,E=s-r,m=y*y+E*E;if(m>4*e&&d--){var S=u+h,x=c+g,N=l+v,b=Math.sqrt(S*S+x*x+N*N),q=Math.asin(N/=b),w=An(An(N)-1)<xn||An(i-p)<xn?(i+p)/2:Math.atan2(x,S),P=n(w,q),j=P[0],A=P[1],z=j-t,I=A-r,R=E*z-y*I;(R*R/m>e||An((y*z+E*I)/m-.5)>.3||a>u*h+c*g+l*v)&&(o(t,r,i,u,c,l,j,A,w,S/=b,x/=b,N,d,M),M.point(j,A),o(j,A,w,S,x,N,f,s,p,h,g,v,d,M))}}var e=.5,a=Math.cos(30*Pn),u=16;return t.precision=function(n){return arguments.length?(u=(e=n*n)>0&&16,t):Math.sqrt(e)},t}function X(n){this.stream=n}function Y(n,t){return{point:t,sphere:function(){n.sphere()},lineStart:function(){n.lineStart()},lineEnd:function(){n.lineEnd()},polygonStart:function(){n.polygonStart()},polygonEnd:function(){n.polygonEnd()}}}function $(n){return _(function(){return n})()}function _(n){function t(n){return n=c(n[0]*Pn,n[1]*Pn),[n[0]*h+l,f-n[1]*h]}function r(n){return n=c.invert((n[0]-l)/h,(f-n[1])/h),n&&[n[0]*jn,n[1]*jn]}function i(){c=z(u=L(y,E,m),a);var n=a(d,M);return l=g-n[0]*h,f=v+n[1]*h,o()}function o(){return s&&(s.valid=!1,s=null),t}var a,u,c,l,f,s,p=W(function(n,t){return n=a(n,t),[n[0]*h+l,f-n[1]*h]}),h=150,g=480,v=250,d=0,M=0,y=0,E=0,m=0,S=zn,x=e,N=null,b=null;return t.stream=function(n){return s&&(s.valid=!1),s=nn(S(u,p(x(n)))),s.valid=!0,s},t.clipAngle=function(n){return arguments.length?(S=null==n?(N=n,zn):K((N=+n)*Pn),o()):N},t.clipExtent=function(n){return arguments.length?(b=n,x=n?V(n[0][0],n[0][1],n[1][0],n[1][1]):e,o()):b},t.scale=function(n){return arguments.length?(h=+n,i()):h},t.translate=function(n){return arguments.length?(g=+n[0],v=+n[1],i()):[g,v]},t.center=function(n){return arguments.length?(d=n[0]%360*Pn,M=n[1]%360*Pn,i()):[d*jn,M*jn]},t.rotate=function(n){return arguments.length?(y=n[0]%360*Pn,E=n[1]%360*Pn,m=n.length>2?n[2]%360*Pn:0,i()):[y*jn,E*jn,m*jn]},Sn.rebind(t,p,"precision"),function(){return a=n.apply(this,arguments),t.invert=a.invert&&r,i()}}function nn(n){return Y(n,function(t,r){n.point(t*Pn,r*Pn)})}function tn(n){var t=0,r=bn/3,i=_(n),o=i(t,r);return o.parallels=function(n){return arguments.length?i(t=n[0]*bn/180,r=n[1]*bn/180):[t/bn*180,r/bn*180]},o}function rn(n,t){function r(n,t){var r=Math.sqrt(e-2*o*Math.sin(t))/o;return[r*Math.sin(n*=o),a-r*Math.cos(n)]}var i=Math.sin(n),o=(i+Math.sin(t))/2,e=1+i*(2*o-i),a=Math.sqrt(e)/o;return r.invert=function(n,t){var r=a-t;return[Math.atan2(n,r)/o,c((e-(n*n+r*r)*o*o)/(2*o))]},r}function on(n,t){n*=Pn;var r=Math.cos(t*=Pn);en(r*Math.cos(n),r*Math.sin(n),Math.sin(t))}function en(n,t,r){++Gn,Un+=(n-Un)/Gn,Zn+=(t-Zn)/Gn,Bn+=(r-Bn)/Gn}function an(){function n(n,o){n*=Pn;var e=Math.cos(o*=Pn),a=e*Math.cos(n),u=e*Math.sin(n),c=Math.sin(o),l=Math.atan2(Math.sqrt((l=r*c-i*u)*l+(l=i*a-t*c)*l+(l=t*u-r*a)*l),t*a+r*u+i*c);Tn+=l,Dn+=l*(t+(t=a)),Hn+=l*(r+(r=u)),Jn+=l*(i+(i=c)),en(t,r,i)}var t,r,i;tt.point=function(o,e){o*=Pn;var a=Math.cos(e*=Pn);t=a*Math.cos(o),r=a*Math.sin(o),i=Math.sin(e),tt.point=n,en(t,r,i)}}function un(){tt.point=on}function cn(){function n(n,t){n*=Pn;var r=Math.cos(t*=Pn),a=r*Math.cos(n),c=r*Math.sin(n),l=Math.sin(t),f=o*l-e*c,s=e*a-i*l,p=i*c-o*a,h=Math.sqrt(f*f+s*s+p*p),g=i*a+o*c+e*l,v=h&&-u(g)/h,d=Math.atan2(h,g);Kn+=v*f,Qn+=v*s,Vn+=v*p,Tn+=d,Dn+=d*(i+(i=a)),Hn+=d*(o+(o=c)),Jn+=d*(e+(e=l)),en(i,o,e)}var t,r,i,o,e;tt.point=function(a,u){t=a,r=u,tt.point=n,a*=Pn;var c=Math.cos(u*=Pn);i=c*Math.cos(a),o=c*Math.sin(a),e=Math.sin(u),en(i,o,e)},tt.lineEnd=function(){n(t,r),tt.lineEnd=un,tt.point=on}}function ln(){function n(n,t){Xn+=o*n-i*t,i=n,o=t}var t,r,i,o;rt.point=function(e,a){rt.point=n,t=i=e,r=o=a},rt.lineEnd=function(){n(t,r)}}function fn(n,t){Yn>n&&(Yn=n),n>_n&&(_n=n),$n>t&&($n=t),t>nt&&(nt=t)}function sn(){function n(n,t){a.push("M",n,",",t,e)}function t(n,t){a.push("M",n,",",t),u.point=r}function r(n,t){a.push("L",n,",",t)}function i(){u.point=n}function o(){a.push("Z")}var e=pn(4.5),a=[],u={point:n,lineStart:function(){u.point=t},lineEnd:i,polygonStart:function(){u.lineEnd=o},polygonEnd:function(){u.lineEnd=i,u.point=n},pointRadius:function(n){return e=pn(n),u},result:function(){if(a.length){var n=a.join("");return a=[],n}}};return u}function pn(n){return"m0,"+n+"a"+n+","+n+" 0 1,1 0,"+-2*n+"a"+n+","+n+" 0 1,1 0,"+2*n+"z"}function hn(n,t){Un+=n,Zn+=t,++Bn}function gn(){function n(n,i){var o=n-t,e=i-r,a=Math.sqrt(o*o+e*e);Dn+=a*(t+n)/2,Hn+=a*(r+i)/2,Jn+=a,hn(t=n,r=i)}var t,r;ot.point=function(i,o){ot.point=n,hn(t=i,r=o)}}function vn(){ot.point=hn}function dn(){function n(n,t){var r=n-i,e=t-o,a=Math.sqrt(r*r+e*e);Dn+=a*(i+n)/2,Hn+=a*(o+t)/2,Jn+=a,a=o*n-i*t,Kn+=a*(i+n),Qn+=a*(o+t),Vn+=3*a,hn(i=n,o=t)}var t,r,i,o;ot.point=function(e,a){ot.point=n,hn(t=i=e,r=o=a)},ot.lineEnd=function(){n(t,r)}}function Mn(n){function t(t,r){n.moveTo(t+a,r),n.arc(t,r,a,0,qn)}function r(t,r){n.moveTo(t,r),u.point=i}function i(t,r){n.lineTo(t,r)}function o(){u.point=t}function e(){n.closePath()}var a=4.5,u={point:t,lineStart:function(){u.point=r},lineEnd:o,polygonStart:function(){u.lineEnd=e},polygonEnd:function(){u.lineEnd=o,u.point=t},pointRadius:function(n){return a=n,u},result:s};return u}function yn(n){var t=W(function(t,r){return n([t*jn,r*jn])});return function(n){return nn(t(n))}}function En(n,t){return[n,Math.log(Math.tan(bn/4+t/2))]}function mn(n){var t,r=$(n),i=r.scale,o=r.translate,e=r.clipExtent;return r.scale=function(){var n=i.apply(r,arguments);return n===r?t?r.clipExtent(null):r:n},r.translate=function(){var n=o.apply(r,arguments);return n===r?t?r.clipExtent(null):r:n},r.clipExtent=function(n){var a=e.apply(r,arguments);if(a===r){if(t=null==n){var u=bn*i(),c=o();e([[c[0]-u,c[1]-u],[c[0]+u,c[1]+u]])}}else t&&(a=null);return a},r.clipExtent(null)}var Sn={version:"3.5.5"},xn=1e-6,Nn=xn*xn,bn=Math.PI,qn=2*bn,wn=bn/2,Pn=bn/180,jn=180/bn;Sn.geo={},Sn.rebind=function(n,t){for(var r,i=1,o=arguments.length;++i<o;)n[r=arguments[i]]=l(n,t,t[r]);return n};var An=Math.abs;Sn.merge=function(n){for(var t,r,i,o=n.length,e=-1,a=0;++e<o;)a+=n[e].length;for(r=new Array(a);--o>=0;)for(i=n[o],t=i.length;--t>=0;)r[--a]=i[t];return r};var zn=M(f,S,N,[-bn,-bn/2]);(Sn.geo.equirectangular=function(){return $(I)}).raw=I.invert=I,Sn.geo.rotation=function(n){function t(t){return t=n(t[0]*Pn,t[1]*Pn),t[0]*=jn,t[1]*=jn,t}return n=L(n[0]%360*Pn,n[1]*Pn,n.length>2?n[2]*Pn:0),t.invert=function(t){return t=n.invert(t[0]*Pn,t[1]*Pn),t[0]*=jn,t[1]*=jn,t},t},R.invert=I,Sn.geo.circle=function(){function n(){var n="function"==typeof i?i.apply(this,arguments):i,t=L(-n[0]*Pn,-n[1]*Pn,0).invert,o=[];return r(null,null,1,{point:function(n,r){o.push(n=t(n,r)),n[0]*=jn,n[1]*=jn}}),{type:"Polygon",coordinates:[o]}}var t,r,i=[0,0],o=6;return n.origin=function(t){return arguments.length?(i=t,n):i},n.angle=function(i){return arguments.length?(r=F((t=+i)*Pn,o*Pn),n):t},n.precision=function(i){return arguments.length?(r=F(t*Pn,(o=+i)*Pn),n):o},n.angle(90)},T.prototype={s:0,t:0,add:function(n){U(n,this.t,In),U(In.s,this.s,this),this.s?this.t+=In.t:this.s=In.t},reset:function(){this.s=this.t=0},valueOf:function(){return this.s}};var In=new T;Sn.geo.stream=function(n,t){n&&Rn.hasOwnProperty(n.type)?Rn[n.type](n,t):Z(n,t)};var Rn={Feature:function(n,t){Z(n.geometry,t)},FeatureCollection:function(n,t){for(var r=n.features,i=-1,o=r.length;++i<o;)Z(r[i].geometry,t)}},Ln={Sphere:function(n,t){t.sphere()},Point:function(n,t){n=n.coordinates,t.point(n[0],n[1],n[2])},MultiPoint:function(n,t){for(var r=n.coordinates,i=-1,o=r.length;++i<o;)n=r[i],t.point(n[0],n[1],n[2])},LineString:function(n,t){B(n.coordinates,t,0)},MultiLineString:function(n,t){for(var r=n.coordinates,i=-1,o=r.length;++i<o;)B(r[i],t,0)},Polygon:function(n,t){D(n.coordinates,t)},MultiPolygon:function(n,t){for(var r=n.coordinates,i=-1,o=r.length;++i<o;)D(r[i],t)},GeometryCollection:function(n,t){for(var r=n.geometries,i=-1,o=r.length;++i<o;)Z(r[i],t)}};Sn.geo.area=function(n){return On=0,Sn.geo.stream(n,Cn),On};var On,kn=new T,Cn={sphere:function(){On+=4*bn},point:s,lineStart:s,lineEnd:s,polygonStart:function(){kn.reset(),Cn.lineStart=H},polygonEnd:function(){var n=2*kn;On+=0>n?4*bn+n:n,Cn.lineStart=Cn.lineEnd=Cn.point=s}},Fn=1e9;Sn.geo.clipExtent=function(){var n,t,r,i,o,e,a={stream:function(n){return o&&(o.valid=!1),o=e(n),o.valid=!0,o},extent:function(u){return arguments.length?(e=V(n=+u[0][0],t=+u[0][1],r=+u[1][0],i=+u[1][1]),o&&(o.valid=!1,o=null),a):[[n,t],[r,i]]}};return a.extent([[0,0],[960,500]])};[].slice;Sn.geo.transform=function(n){return{stream:function(t){var r=new X(t);for(var i in n)r[i]=n[i];return r}}},X.prototype={point:function(n,t){this.stream.point(n,t)},sphere:function(){this.stream.sphere()},lineStart:function(){this.stream.lineStart()},lineEnd:function(){this.stream.lineEnd()},polygonStart:function(){this.stream.polygonStart()},polygonEnd:function(){this.stream.polygonEnd()}},Sn.geo.projection=$,Sn.geo.projectionMutator=_,(Sn.geo.conicEqualArea=function(){return tn(rn)}).raw=rn,Sn.geo.albers=function(){return Sn.geo.conicEqualArea().rotate([96,0]).center([-.6,38.7]).parallels([29.5,45.5]).scale(1070)},Sn.geo.albersUsa=function(){function n(n){var e=n[0],a=n[1];return t=null,r(e,a),t||(i(e,a),t)||o(e,a),t}var t,r,i,o,e=Sn.geo.albers(),a=Sn.geo.conicEqualArea().rotate([154,0]).center([-2,58.5]).parallels([55,65]),u=Sn.geo.conicEqualArea().rotate([157,0]).center([-3,19.9]).parallels([8,18]),c={point:function(n,r){t=[n,r]}};return n.invert=function(n){var t=e.scale(),r=e.translate(),i=(n[0]-r[0])/t,o=(n[1]-r[1])/t;return(o>=.12&&.234>o&&i>=-.425&&-.214>i?a:o>=.166&&.234>o&&i>=-.214&&-.115>i?u:e).invert(n)},n.stream=function(n){var t=e.stream(n),r=a.stream(n),i=u.stream(n);return{point:function(n,o){t.point(n,o),r.point(n,o),i.point(n,o)},sphere:function(){t.sphere(),r.sphere(),i.sphere()},lineStart:function(){t.lineStart(),r.lineStart(),i.lineStart()},lineEnd:function(){t.lineEnd(),r.lineEnd(),i.lineEnd()},polygonStart:function(){t.polygonStart(),r.polygonStart(),i.polygonStart()},polygonEnd:function(){t.polygonEnd(),r.polygonEnd(),i.polygonEnd()}}},n.precision=function(t){return arguments.length?(e.precision(t),a.precision(t),u.precision(t),n):e.precision()},n.scale=function(t){return arguments.length?(e.scale(t),a.scale(.35*t),u.scale(t),n.translate(e.translate())):e.scale()},n.translate=function(t){if(!arguments.length)return e.translate();var l=e.scale(),f=+t[0],s=+t[1];return r=e.translate(t).clipExtent([[f-.455*l,s-.238*l],[f+.455*l,s+.238*l]]).stream(c).point,i=a.translate([f-.307*l,s+.201*l]).clipExtent([[f-.425*l+xn,s+.12*l+xn],[f-.214*l-xn,s+.234*l-xn]]).stream(c).point,o=u.translate([f-.205*l,s+.212*l]).clipExtent([[f-.214*l+xn,s+.166*l+xn],[f-.115*l-xn,s+.234*l-xn]]).stream(c).point,n},n.scale(1070)},Sn.geo.bounds=function(){function n(n,t){m.push(S=[f=n,h=n]),s>t&&(s=t),t>g&&(g=t)}function t(t,r){var i=b([t*Pn,r*Pn]);if(y){var o=w(y,i),e=[o[1],-o[0],0],a=w(e,o);A(a),a=p(a);var c=t-v,l=c>0?1:-1,d=a[0]*jn*l,M=An(c)>180;if(M^(d>l*v&&l*t>d)){var E=a[1]*jn;E>g&&(g=E)}else if(d=(d+360)%360-180,M^(d>l*v&&l*t>d)){var E=-a[1]*jn;s>E&&(s=E)}else s>r&&(s=r),r>g&&(g=r);M?v>t?u(f,t)>u(f,h)&&(h=t):u(t,h)>u(f,h)&&(f=t):h>=f?(f>t&&(f=t),t>h&&(h=t)):t>v?u(f,t)>u(f,h)&&(h=t):u(t,h)>u(f,h)&&(f=t)}else n(t,r);y=i,v=t}function r(){x.point=t}function i(){S[0]=f,S[1]=h,x.point=n,y=null}function o(n,r){if(y){var i=n-v;E+=An(i)>180?i+(i>0?360:-360):i}else d=n,M=r;Cn.point(n,r),t(n,r)}function e(){Cn.lineStart()}function a(){o(d,M),Cn.lineEnd(),An(E)>xn&&(f=-(h=180)),S[0]=f,S[1]=h,y=null}function u(n,t){return(t-=n)<0?t+360:t}function c(n,t){return n[0]-t[0]}function l(n,t){return t[0]<=t[1]?t[0]<=n&&n<=t[1]:n<t[0]||t[1]<n}var f,s,h,g,v,d,M,y,E,m,S,x={point:n,lineStart:r,lineEnd:i,polygonStart:function(){x.point=o,x.lineStart=e,x.lineEnd=a,E=0,Cn.polygonStart()},polygonEnd:function(){Cn.polygonEnd(),x.point=n,x.lineStart=r,x.lineEnd=i,0>kn?(f=-(h=180),s=-(g=90)):E>xn?g=90:-xn>E&&(s=-90),S[0]=f,S[1]=h}};return function(n){g=h=-(f=s=1/0),m=[],Sn.geo.stream(n,x);var t=m.length;if(t){m.sort(c);for(var r,i=1,o=m[0],e=[o];t>i;++i)r=m[i],l(r[0],o)||l(r[1],o)?(u(o[0],r[1])>u(o[0],o[1])&&(o[1]=r[1]),u(r[0],o[1])>u(o[0],o[1])&&(o[0]=r[0])):e.push(o=r);for(var a,r,p=-(1/0),t=e.length-1,i=0,o=e[t];t>=i;o=r,++i)r=e[i],(a=u(o[1],r[0]))>p&&(p=a,f=r[0],h=o[1])}return m=S=null,f===1/0||s===1/0?[[NaN,NaN],[NaN,NaN]]:[[f,s],[h,g]]}}(),Sn.geo.centroid=function(n){Gn=Tn=Un=Zn=Bn=Dn=Hn=Jn=Kn=Qn=Vn=0,Sn.geo.stream(n,tt);var t=Kn,r=Qn,i=Vn,o=t*t+r*r+i*i;return Nn>o&&(t=Dn,r=Hn,i=Jn,xn>Tn&&(t=Un,r=Zn,i=Bn),o=t*t+r*r+i*i,Nn>o)?[NaN,NaN]:[Math.atan2(r,t)*jn,c(i/Math.sqrt(o))*jn]};var Gn,Tn,Un,Zn,Bn,Dn,Hn,Jn,Kn,Qn,Vn,Wn,Xn,Yn,$n,_n,nt,tt={sphere:s,point:on,lineStart:an,lineEnd:un,polygonStart:function(){tt.lineStart=cn},polygonEnd:function(){tt.lineStart=an}},rt={point:s,lineStart:s,lineEnd:s,polygonStart:function(){Xn=0,rt.lineStart=ln},polygonEnd:function(){rt.lineStart=rt.lineEnd=rt.point=s,Wn+=An(Xn/2)}},it={point:fn,lineStart:s,lineEnd:s,polygonStart:s,polygonEnd:s},ot={point:hn,lineStart:gn,lineEnd:vn,polygonStart:function(){ot.lineStart=dn},polygonEnd:function(){ot.point=hn,ot.lineStart=gn,ot.lineEnd=vn}};Sn.geo.path=function(){function n(n){return n&&("function"==typeof c&&a.pointRadius(+c.apply(this,arguments)),u&&u.valid||(u=o(a)),Sn.geo.stream(n,u)),a.result()}function t(){return u=null,n}var r,i,o,a,u,c=4.5;return n.area=function(n){return Wn=0,Sn.geo.stream(n,o(rt)),Wn},n.centroid=function(n){return Un=Zn=Bn=Dn=Hn=Jn=Kn=Qn=Vn=0,Sn.geo.stream(n,o(ot)),Vn?[Kn/Vn,Qn/Vn]:Jn?[Dn/Jn,Hn/Jn]:Bn?[Un/Bn,Zn/Bn]:[NaN,NaN]},n.bounds=function(n){return _n=nt=-(Yn=$n=1/0),Sn.geo.stream(n,o(it)),[[Yn,$n],[_n,nt]]},n.projection=function(n){return arguments.length?(o=(r=n)?n.stream||yn(n):e,t()):r},n.context=function(n){return arguments.length?(a=null==(i=n)?new sn:new Mn(n),"function"!=typeof c&&a.pointRadius(c),t()):i},n.pointRadius=function(t){return arguments.length?(c="function"==typeof t?t:(a.pointRadius(+t),+t),n):c},n.projection(Sn.geo.albersUsa()).context(null)},En.invert=function(n,t){return[n,2*Math.atan(Math.exp(t))-wn]},(Sn.geo.mercator=function(){return mn(En)}).raw=En,i=Sn,o="function"==typeof i?i.call(t,r,t,n):i,!(void 0!==o&&(n.exports=o)),this.d3f=Sn}()},function(n,t){function r(n){var t={};for(var r in n)t[r]=o.copy(n[r]);return t}function i(n,t){for(var r,i=n.length,o=i-t;o<--i;)r=n[o],n[o++]=n[i],n[i]=r}var o={};o.copy=function(n){return n instanceof Array?n.map(o.copy):"string"==typeof n||"number"==typeof n?n:r(n)},o.arctans=function(n,t){var r=n/t,i=Math.sqrt(1+r*r),o=t>0?i:-i,e=1/o,a=r*e;return{cos:e,sin:a}},o.object=function(n,t){function r(t,r){r.length&&r.pop();for(var o=n[0>t?~t:t],e=0,a=o.length;a>e;++e)r.push(o[e]);0>t&&i(r,a)}function o(n){for(var t=[],i=0,o=n.length;o>i;++i)r(n[i],t);return t}function e(n){return n.map(o)}function a(n){return n=Object.create(n),n.properties=n.properties,n.coordinates=u[n.type](n.arcs),n.type=n.type,n}var u={LineString:o,MultiLineString:e,Polygon:e,MultiPolygon:function(n){return n.map(e)}};return"GeometryCollection"===t.type?(t=Object.create(t),t.geometries=t.geometries.map(a),t):a(t)},o.properties=function(n){return n.properties||{}},o.transformer=function(n){function t(n){return[n[0]*r+o,n[1]*i+e]}var r=n.scale[0],i=n.scale[1],o=n.translate[0],e=n.translate[1];return t.invert=function(n){return[(n[0]-o)/r,(n[1]-e)/i]},t},n.exports=o}]);',r.p+"2623f394d64d470ff1d8.worker.js")}},function(n,t){var r=window.URL||window.webkitURL;n.exports=function(n,t){try{try{var i;try{var o=window.BlobBuilder||window.WebKitBlobBuilder||window.MozBlobBuilder||window.MSBlobBuilder;i=new o,i.append(n),i=i.getBlob()}catch(e){i=new Blob([n])}return new Worker(r.createObjectURL(i))}catch(e){return new Worker("data:application/javascript,"+encodeURIComponent(n))}}catch(e){return new Worker(t)}}},function(n,t,r){function i(){}function o(n){function t(n){return h[n.properties[g]]}var r=n;if("undefined"!=typeof n.data&&(r=n.data),"carto"===r["do"]){var i=r.geo,o=i.topology,u=i.geometries,c=i.path,l=i.translation,f=i.projection.name,s=i.projection.scaling,p=i.projection.center,l=i.projection.translation,h=r.values,g=r.featureProperty,v=r.task;o=a.copy(o);var d=e.geo[f]().scale(s);null!=p&&d.center(p),null!=l&&d.translate(l);for(var M,y,m,E,S,x=a.transformer(o.transform),b=o.arcs.length,N=0,w=new Array(b);b>N;){for(M=0,y=0,m=o.arcs[N].length,E=0,S=new Array(m);m>E;)o.arcs[N][E][0]=M+=o.arcs[N][E][0],o.arcs[N][E][1]=y+=o.arcs[N][E][1],S[E]=d(x(o.arcs[N][E])),E++;w[N++]=S}for(var c=e.geo.path().projection(null),q=a.object(w,{type:"GeometryCollection",geometries:u}).geometries.map(function(n){return{type:"Feature",id:n.id,properties:a.properties.call(null,n,o),geometry:n}}),P=q.map(t),j=P.reduce(function(n,t){return n+t}),A=8,R=0;R++<A;){for(var I=[],O=0,k=0;k<q.length;k++){var z=c.area(q[k]);I.push(z),O+=z}for(var C=0,B=0,L=[],F=0;F<q.length;F++){var G=q[F],z=Math.abs(I[F]),U=+P[F],D=O*U/j,W=Math.sqrt(z/Math.PI),Z=Math.sqrt(D/Math.PI)-W,T=Math.max(z,D)/Math.min(z,D);C+=T,B++,L.push({id:G.id,area:z,centroid:c.centroid(G),value:U,desired:D,range:100*Math.abs(D-z)/Math.sqrt(Math.PI*z),radius:W,mass:Z,sizeError:T})}for(var m,E,J,J,_,H,Q,Z,W,V,K,Y,$,X,nn,T=C/B,tn=1/(1+T),b=w.length,N=0;b>N;){for(m=w[N].length,E=0;m>E;){for(J=[0,0],_=L.length,H=0;_>H;){if(Q=L[H].centroid,Z=L[H].mass,W=L[H].radius,V=W*W,K=w[N][E][0]-Q[0],Y=w[N][E][1]-Q[1],$=K*K+Y*Y,X=Math.sqrt($),X<L[H].range){nn=X>W?Z*W/X:Z*($/V)*(4-3*X/W);var rn=a.arctans(Y,K);J[0]+=nn*rn.cos,J[1]+=nn*rn.sin}H++}w[N][E][0]+=J[0]*tn,w[N][E][1]+=J[1]*tn,E++}N++}if(1>=T)break}var on={done:"processing",features:q,task:v};"undefined"!=typeof self?self.postMessage(on):this.onmessage(on)}}var e=r(4),a=r(5);"undefined"!=typeof onmessage?onmessage=o:(i.prototype.postMessage=o,i.prototype.terminate=function(){},n.exports=i)},function(n,t,r){var i,o;!function(){function e(n){return n}function a(n,t,r){return(t[0]-n[0])*(r[1]-n[1])-(t[1]-n[1])*(r[0]-n[0]);
}function u(n){return n>1?0:-1>n?Nn:Math.acos(n)}function c(n){return n>1?qn:-1>n?-qn:Math.asin(n)}function l(n,t,r){return function(){var i=r.apply(t,arguments);return i===t?n:i}}function f(){return!0}function s(){}function p(n){return[Math.atan2(n[1],n[0]),c(n[2])]}function h(n,t){return An(n[0]-t[0])<xn&&An(n[1]-t[1])<xn}function g(n,t,r,i,o){var e=[],a=[];if(n.forEach(function(n){if(!((t=n.length-1)<=0)){var t,r=n[0],i=n[t];if(h(r,i)){o.lineStart();for(var u=0;t>u;++u)o.point((r=n[u])[0],r[1]);return void o.lineEnd()}var c=new d(r,n,null,!0),l=new d(r,null,c,!1);c.o=l,e.push(c),a.push(l),c=new d(i,n,null,!1),l=new d(i,null,c,!0),c.o=l,e.push(c),a.push(l)}}),a.sort(t),v(e),v(a),e.length){for(var u=0,c=r,l=a.length;l>u;++u)a[u].e=c=!c;for(var f,s,p=e[0];;){for(var g=p,M=!0;g.v;)if((g=g.n)===p)return;f=g.z,o.lineStart();do{if(g.v=g.o.v=!0,g.e){if(M)for(var u=0,l=f.length;l>u;++u)o.point((s=f[u])[0],s[1]);else i(g.x,g.n.x,1,o);g=g.n}else{if(M){f=g.p.z;for(var u=f.length-1;u>=0;--u)o.point((s=f[u])[0],s[1])}else i(g.x,g.p.x,-1,o);g=g.p}g=g.o,f=g.z,M=!M}while(!g.v);o.lineEnd()}}}function v(n){if(t=n.length){for(var t,r,i=0,o=n[0];++i<t;)o.n=r=n[i],r.p=o,o=r;o.n=r=n[0],r.p=o}}function d(n,t,r,i){this.x=n,this.z=t,this.o=r,this.e=i,this.v=!1,this.n=this.p=null}function M(n,t,r,i){return function(o,e){function a(t,r){var i=o(t,r);n(t=i[0],r=i[1])&&e.point(t,r)}function u(n,t){var r=o(n,t);M.point(r[0],r[1])}function c(){x.point=u,M.lineStart()}function l(){x.point=a,M.lineEnd()}function f(n,t){d.push([n,t]);var r=o(n,t);N.point(r[0],r[1])}function s(){N.lineStart(),d=[]}function p(){f(d[0][0],d[0][1]),N.lineEnd();var n,t=N.clean(),r=b.buffer(),i=r.length;if(d.pop(),v.push(d),d=null,i)if(1&t){n=r[0];var o,i=n.length-1,a=-1;if(i>0){for(w||(e.polygonStart(),w=!0),e.lineStart();++a<i;)e.point((o=n[a])[0],o[1]);e.lineEnd()}}else i>1&&2&t&&r.push(r.pop().concat(r.shift())),h.push(r.filter(y))}var h,v,d,M=t(e),S=o.invert(i[0],i[1]),x={point:a,lineStart:c,lineEnd:l,polygonStart:function(){x.point=f,x.lineStart=s,x.lineEnd=p,h=[],v=[]},polygonEnd:function(){x.point=a,x.lineStart=c,x.lineEnd=l,h=Sn.merge(h);var n=J(S,v);h.length?(w||(e.polygonStart(),w=!0),g(h,E,n,r,e)):n&&(w||(e.polygonStart(),w=!0),e.lineStart(),r(null,null,1,e),e.lineEnd()),w&&(e.polygonEnd(),w=!1),h=v=null},sphere:function(){e.polygonStart(),e.lineStart(),r(null,null,1,e),e.lineEnd(),e.polygonEnd()}},b=m(),N=t(b),w=!1;return x}}function y(n){return n.length>1}function m(){var n,t=[];return{lineStart:function(){t.push(n=[])},point:function(t,r){n.push([t,r])},lineEnd:s,buffer:function(){var r=t;return t=[],n=null,r},rejoin:function(){t.length>1&&t.push(t.pop().concat(t.shift()))}}}function E(n,t){return((n=n.x)[0]<0?n[1]-qn-xn:qn-n[1])-((t=t.x)[0]<0?t[1]-qn-xn:qn-t[1])}function S(n){var t,r=NaN,i=NaN,o=NaN;return{lineStart:function(){n.lineStart(),t=1},point:function(e,a){var u=e>0?Nn:-Nn,c=An(e-r);An(c-Nn)<xn?(n.point(r,i=(i+a)/2>0?qn:-qn),n.point(o,i),n.lineEnd(),n.lineStart(),n.point(u,i),n.point(e,i),t=0):o!==u&&c>=Nn&&(An(r-o)<xn&&(r-=o*xn),An(e-u)<xn&&(e-=u*xn),i=x(r,i,e,a),n.point(o,i),n.lineEnd(),n.lineStart(),n.point(u,i),t=0),n.point(r=e,i=a),o=u},lineEnd:function(){n.lineEnd(),r=i=NaN},clean:function(){return 2-t}}}function x(n,t,r,i){var o,e,a=Math.sin(n-r);return An(a)>xn?Math.atan((Math.sin(t)*(e=Math.cos(i))*Math.sin(r)-Math.sin(i)*(o=Math.cos(t))*Math.sin(n))/(o*e*a)):(t+i)/2}function b(n,t,r,i){var o;if(null==n)o=r*qn,i.point(-Nn,o),i.point(0,o),i.point(Nn,o),i.point(Nn,0),i.point(Nn,-o),i.point(0,-o),i.point(-Nn,-o),i.point(-Nn,0),i.point(-Nn,o);else if(An(n[0]-t[0])>xn){var e=n[0]<t[0]?Nn:-Nn;o=r*e/2,i.point(-e,o),i.point(0,o),i.point(e,o)}else i.point(t[0],t[1])}function N(n){var t=n[0],r=n[1],i=Math.cos(r);return[i*Math.cos(t),i*Math.sin(t),Math.sin(r)]}function w(n,t){return n[0]*t[0]+n[1]*t[1]+n[2]*t[2]}function q(n,t){return[n[1]*t[2]-n[2]*t[1],n[2]*t[0]-n[0]*t[2],n[0]*t[1]-n[1]*t[0]]}function P(n,t){n[0]+=t[0],n[1]+=t[1],n[2]+=t[2]}function j(n,t){return[n[0]*t,n[1]*t,n[2]*t]}function A(n){var t=Math.sqrt(n[0]*n[0]+n[1]*n[1]+n[2]*n[2]);n[0]/=t,n[1]/=t,n[2]/=t}function R(n,t){function r(r,i){return r=n(r,i),t(r[0],r[1])}return n.invert&&t.invert&&(r.invert=function(r,i){return r=t.invert(r,i),r&&n.invert(r[0],r[1])}),r}function I(n,t){return[n,t]}function O(n,t){return[n>Nn?n-wn:-Nn>n?n+wn:n,t]}function k(n,t,r){return n?t||r?R(C(n),B(t,r)):C(n):t||r?B(t,r):O}function z(n){return function(t,r){return t+=n,[t>Nn?t-wn:-Nn>t?t+wn:t,r]}}function C(n){var t=z(n);return t.invert=z(-n),t}function B(n,t){function r(n,t){var r=Math.cos(t),u=Math.cos(n)*r,l=Math.sin(n)*r,f=Math.sin(t),s=f*i+u*o;return[Math.atan2(l*e-s*a,u*i-f*o),c(s*e+l*a)]}var i=Math.cos(n),o=Math.sin(n),e=Math.cos(t),a=Math.sin(t);return r.invert=function(n,t){var r=Math.cos(t),u=Math.cos(n)*r,l=Math.sin(n)*r,f=Math.sin(t),s=f*e-l*a;return[Math.atan2(l*e+f*a,u*i+s*o),c(s*i-u*o)]},r}function L(n,t){var r=Math.cos(n),i=Math.sin(n);return function(o,e,a,u){var c=a*t;null!=o?(o=F(r,o),e=F(r,e),(a>0?e>o:o>e)&&(o+=a*wn)):(o=n+a*wn,e=n-.5*c);for(var l,f=o;a>0?f>e:e>f;f-=c)u.point((l=p([r,-i*Math.cos(f),-i*Math.sin(f)]))[0],l[1])}}function F(n,t){var r=N(t);r[0]-=n,A(r);var i=u(-r[1]);return((-r[2]<0?-i:i)+2*Math.PI-xn)%(2*Math.PI)}function G(){}function U(n,t,r){var i=r.s=n+t,o=i-n,e=i-o;r.t=n-e+(t-o)}function D(n,t){n&&kn.hasOwnProperty(n.type)&&kn[n.type](n,t)}function W(n,t,r){var i,o=-1,e=n.length-r;for(t.lineStart();++o<e;)i=n[o],t.point(i[0],i[1],i[2]);t.lineEnd()}function Z(n,t){var r=-1,i=n.length;for(t.polygonStart();++r<i;)W(n[r],t,1);t.polygonEnd()}function T(){function n(n,t){n*=Pn,t=t*Pn/2+Nn/4;var r=n-i,a=r>=0?1:-1,u=a*r,c=Math.cos(t),l=Math.sin(t),f=e*l,s=o*c+f*Math.cos(u),p=f*a*Math.sin(u);Cn.add(Math.atan2(p,s)),i=n,o=c,e=l}var t,r,i,o,e;Bn.point=function(a,u){Bn.point=n,i=(t=a)*Pn,o=Math.cos(u=(r=u)*Pn/2+Nn/4),e=Math.sin(u)},Bn.lineEnd=function(){n(t,r)}}function J(n,t){var r=n[0],i=n[1],o=[Math.sin(r),-Math.cos(r),0],e=0,a=0;Cn.reset();for(var u=0,l=t.length;l>u;++u){var f=t[u],s=f.length;if(s)for(var p=f[0],h=p[0],g=p[1]/2+Nn/4,v=Math.sin(g),d=Math.cos(g),M=1;;){M===s&&(M=0),n=f[M];var y=n[0],m=n[1]/2+Nn/4,E=Math.sin(m),S=Math.cos(m),x=y-h,b=x>=0?1:-1,w=b*x,P=w>Nn,j=v*E;if(Cn.add(Math.atan2(j*b*Math.sin(w),d*S+j*Math.cos(w))),e+=P?x+b*wn:x,P^h>=r^y>=r){var R=q(N(p),N(n));A(R);var I=q(o,R);A(I);var O=(P^x>=0?-1:1)*c(I[2]);(i>O||i===O&&(R[0]||R[1]))&&(a+=P^x>=0?1:-1)}if(!M++)break;h=y,v=E,d=S,p=n}}return(-xn>e||xn>e&&0>Cn)^1&a}function _(n){function t(n,t){return Math.cos(n)*Math.cos(t)>e}function r(n){var r,e,c,l,f;return{lineStart:function(){l=c=!1,f=1},point:function(s,p){var g,v=[s,p],d=t(s,p),M=a?d?0:o(s,p):d?o(s+(0>s?Nn:-Nn),p):0;if(!r&&(l=c=d)&&n.lineStart(),d!==c&&(g=i(r,v),(h(r,g)||h(v,g))&&(v[0]+=xn,v[1]+=xn,d=t(v[0],v[1]))),d!==c)f=0,d?(n.lineStart(),g=i(v,r),n.point(g[0],g[1])):(g=i(r,v),n.point(g[0],g[1]),n.lineEnd()),r=g;else if(u&&r&&a^d){var y;M&e||!(y=i(v,r,!0))||(f=0,a?(n.lineStart(),n.point(y[0][0],y[0][1]),n.point(y[1][0],y[1][1]),n.lineEnd()):(n.point(y[1][0],y[1][1]),n.lineEnd(),n.lineStart(),n.point(y[0][0],y[0][1])))}!d||r&&h(r,v)||n.point(v[0],v[1]),r=v,c=d,e=M},lineEnd:function(){c&&n.lineEnd(),r=null},clean:function(){return f|(l&&c)<<1}}}function i(n,t,r){var i=N(n),o=N(t),a=[1,0,0],u=q(i,o),c=w(u,u),l=u[0],f=c-l*l;if(!f)return!r&&n;var s=e*c/f,h=-e*l/f,g=q(a,u),v=j(a,s),d=j(u,h);P(v,d);var M=g,y=w(v,M),m=w(M,M),E=y*y-m*(w(v,v)-1);if(!(0>E)){var S=Math.sqrt(E),x=j(M,(-y-S)/m);if(P(x,v),x=p(x),!r)return x;var b,A=n[0],R=t[0],I=n[1],O=t[1];A>R&&(b=A,A=R,R=b);var k=R-A,z=An(k-Nn)<xn,C=z||xn>k;if(!z&&I>O&&(b=I,I=O,O=b),C?z?I+O>0^x[1]<(An(x[0]-A)<xn?I:O):I<=x[1]&&x[1]<=O:k>Nn^(A<=x[0]&&x[0]<=R)){var B=j(M,(-y+S)/m);return P(B,v),[x,p(B)]}}}function o(t,r){var i=a?n:Nn-n,o=0;return-i>t?o|=1:t>i&&(o|=2),-i>r?o|=4:r>i&&(o|=8),o}var e=Math.cos(n),a=e>0,u=An(e)>xn,c=L(n,6*Pn);return M(t,r,c,a?[0,-n]:[-Nn,n-Nn])}function H(n,t,r,i){return function(o){var e,a=o.a,u=o.b,c=a.x,l=a.y,f=u.x,s=u.y,p=0,h=1,g=f-c,v=s-l;if(e=n-c,g||!(e>0)){if(e/=g,0>g){if(p>e)return;h>e&&(h=e)}else if(g>0){if(e>h)return;e>p&&(p=e)}if(e=r-c,g||!(0>e)){if(e/=g,0>g){if(e>h)return;e>p&&(p=e)}else if(g>0){if(p>e)return;h>e&&(h=e)}if(e=t-l,v||!(e>0)){if(e/=v,0>v){if(p>e)return;h>e&&(h=e)}else if(v>0){if(e>h)return;e>p&&(p=e)}if(e=i-l,v||!(0>e)){if(e/=v,0>v){if(e>h)return;e>p&&(p=e)}else if(v>0){if(p>e)return;h>e&&(h=e)}return p>0&&(o.a={x:c+p*g,y:l+p*v}),1>h&&(o.b={x:c+h*g,y:l+h*v}),o}}}}}}function Q(n,t,r,i){function o(i,o){return An(i[0]-n)<xn?o>0?0:3:An(i[0]-r)<xn?o>0?2:1:An(i[1]-t)<xn?o>0?1:0:o>0?3:2}function e(n,t){return u(n.x,t.x)}function u(n,t){var r=o(n,1),i=o(t,1);return r!==i?r-i:0===r?t[1]-n[1]:1===r?n[0]-t[0]:2===r?n[1]-t[1]:t[0]-n[0]}return function(c){function l(n){for(var t=0,r=y.length,i=n[1],o=0;r>o;++o)for(var e,u=1,c=y[o],l=c.length,f=c[0];l>u;++u)e=c[u],f[1]<=i?e[1]>i&&a(f,e,n)>0&&++t:e[1]<=i&&a(f,e,n)<0&&--t,f=e;return 0!==t}function f(e,a,c,l){var f=0,s=0;if(null==e||(f=o(e,c))!==(s=o(a,c))||u(e,a)<0^c>0){do l.point(0===f||3===f?n:r,f>1?i:t);while((f=(f+c+4)%4)!==s)}else l.point(a[0],a[1])}function s(o,e){return o>=n&&r>=o&&e>=t&&i>=e}function p(n,t){s(n,t)&&c.point(n,t)}function h(){O.point=d,y&&y.push(E=[]),P=!0,q=!1,N=w=NaN}function v(){M&&(d(S,x),b&&q&&R.rejoin(),M.push(R.buffer())),O.point=p,q&&c.lineEnd()}function d(n,t){n=Math.max(-Ln,Math.min(Ln,n)),t=Math.max(-Ln,Math.min(Ln,t));var r=s(n,t);if(y&&E.push([n,t]),P)S=n,x=t,b=r,P=!1,r&&(c.lineStart(),c.point(n,t));else if(r&&q)c.point(n,t);else{var i={a:{x:N,y:w},b:{x:n,y:t}};I(i)?(q||(c.lineStart(),c.point(i.a.x,i.a.y)),c.point(i.b.x,i.b.y),r||c.lineEnd(),j=!1):r&&(c.lineStart(),c.point(n,t),j=!1)}N=n,w=t,q=r}var M,y,E,S,x,b,N,w,q,P,j,A=c,R=m(),I=H(n,t,r,i),O={point:p,lineStart:h,lineEnd:v,polygonStart:function(){c=R,M=[],y=[],j=!0},polygonEnd:function(){c=A,M=Sn.merge(M);var t=l([n,i]),r=j&&t,o=M.length;(r||o)&&(c.polygonStart(),r&&(c.lineStart(),f(null,null,1,c),c.lineEnd()),o&&g(M,e,t,f,c),c.polygonEnd()),M=y=E=null}};return O}}function V(n){function t(n){return(u?i:r)(n)}function r(t){return Y(t,function(r,i){r=n(r,i),t.point(r[0],r[1])})}function i(t){function r(r,i){r=n(r,i),t.point(r[0],r[1])}function i(){m=NaN,w.point=e,t.lineStart()}function e(r,i){var e=N([r,i]),a=n(r,i);o(m,E,y,S,x,b,m=a[0],E=a[1],y=r,S=e[0],x=e[1],b=e[2],u,t),t.point(m,E)}function a(){w.point=r,t.lineEnd()}function c(){i(),w.point=l,w.lineEnd=f}function l(n,t){e(s=n,p=t),h=m,g=E,v=S,d=x,M=b,w.point=e}function f(){o(m,E,y,S,x,b,h,g,s,v,d,M,u,t),w.lineEnd=a,a()}var s,p,h,g,v,d,M,y,m,E,S,x,b,w={point:r,lineStart:i,lineEnd:a,polygonStart:function(){t.polygonStart(),w.lineStart=c},polygonEnd:function(){t.polygonEnd(),w.lineStart=i}};return w}function o(t,r,i,u,c,l,f,s,p,h,g,v,d,M){var y=f-t,m=s-r,E=y*y+m*m;if(E>4*e&&d--){var S=u+h,x=c+g,b=l+v,N=Math.sqrt(S*S+x*x+b*b),w=Math.asin(b/=N),q=An(An(b)-1)<xn||An(i-p)<xn?(i+p)/2:Math.atan2(x,S),P=n(q,w),j=P[0],A=P[1],R=j-t,I=A-r,O=m*R-y*I;(O*O/E>e||An((y*R+m*I)/E-.5)>.3||a>u*h+c*g+l*v)&&(o(t,r,i,u,c,l,j,A,q,S/=N,x/=N,b,d,M),M.point(j,A),o(j,A,q,S,x,b,f,s,p,h,g,v,d,M))}}var e=.5,a=Math.cos(30*Pn),u=16;return t.precision=function(n){return arguments.length?(u=(e=n*n)>0&&16,t):Math.sqrt(e)},t}function K(n){this.stream=n}function Y(n,t){return{point:t,sphere:function(){n.sphere()},lineStart:function(){n.lineStart()},lineEnd:function(){n.lineEnd()},polygonStart:function(){n.polygonStart()},polygonEnd:function(){n.polygonEnd()}}}function $(n){return X(function(){return n})()}function X(n){function t(n){return n=c(n[0]*Pn,n[1]*Pn),[n[0]*h+l,f-n[1]*h]}function r(n){return n=c.invert((n[0]-l)/h,(f-n[1])/h),n&&[n[0]*jn,n[1]*jn]}function i(){c=R(u=k(y,m,E),a);var n=a(d,M);return l=g-n[0]*h,f=v+n[1]*h,o()}function o(){return s&&(s.valid=!1,s=null),t}var a,u,c,l,f,s,p=V(function(n,t){return n=a(n,t),[n[0]*h+l,f-n[1]*h]}),h=150,g=480,v=250,d=0,M=0,y=0,m=0,E=0,S=Rn,x=e,b=null,N=null;return t.stream=function(n){return s&&(s.valid=!1),s=nn(S(u,p(x(n)))),s.valid=!0,s},t.clipAngle=function(n){return arguments.length?(S=null==n?(b=n,Rn):_((b=+n)*Pn),o()):b},t.clipExtent=function(n){return arguments.length?(N=n,x=n?Q(n[0][0],n[0][1],n[1][0],n[1][1]):e,o()):N},t.scale=function(n){return arguments.length?(h=+n,i()):h},t.translate=function(n){return arguments.length?(g=+n[0],v=+n[1],i()):[g,v]},t.center=function(n){return arguments.length?(d=n[0]%360*Pn,M=n[1]%360*Pn,i()):[d*jn,M*jn]},t.rotate=function(n){return arguments.length?(y=n[0]%360*Pn,m=n[1]%360*Pn,E=n.length>2?n[2]%360*Pn:0,i()):[y*jn,m*jn,E*jn]},Sn.rebind(t,p,"precision"),function(){return a=n.apply(this,arguments),t.invert=a.invert&&r,i()}}function nn(n){return Y(n,function(t,r){n.point(t*Pn,r*Pn)})}function tn(n){var t=0,r=Nn/3,i=X(n),o=i(t,r);return o.parallels=function(n){return arguments.length?i(t=n[0]*Nn/180,r=n[1]*Nn/180):[t/Nn*180,r/Nn*180]},o}function rn(n,t){function r(n,t){var r=Math.sqrt(e-2*o*Math.sin(t))/o;return[r*Math.sin(n*=o),a-r*Math.cos(n)]}var i=Math.sin(n),o=(i+Math.sin(t))/2,e=1+i*(2*o-i),a=Math.sqrt(e)/o;return r.invert=function(n,t){var r=a-t;return[Math.atan2(n,r)/o,c((e-(n*n+r*r)*o*o)/(2*o))]},r}function on(n,t){n*=Pn;var r=Math.cos(t*=Pn);en(r*Math.cos(n),r*Math.sin(n),Math.sin(t))}function en(n,t,r){++Fn,Un+=(n-Un)/Fn,Dn+=(t-Dn)/Fn,Wn+=(r-Wn)/Fn}function an(){function n(n,o){n*=Pn;var e=Math.cos(o*=Pn),a=e*Math.cos(n),u=e*Math.sin(n),c=Math.sin(o),l=Math.atan2(Math.sqrt((l=r*c-i*u)*l+(l=i*a-t*c)*l+(l=t*u-r*a)*l),t*a+r*u+i*c);Gn+=l,Zn+=l*(t+(t=a)),Tn+=l*(r+(r=u)),Jn+=l*(i+(i=c)),en(t,r,i)}var t,r,i;tt.point=function(o,e){o*=Pn;var a=Math.cos(e*=Pn);t=a*Math.cos(o),r=a*Math.sin(o),i=Math.sin(e),tt.point=n,en(t,r,i)}}function un(){tt.point=on}function cn(){function n(n,t){n*=Pn;var r=Math.cos(t*=Pn),a=r*Math.cos(n),c=r*Math.sin(n),l=Math.sin(t),f=o*l-e*c,s=e*a-i*l,p=i*c-o*a,h=Math.sqrt(f*f+s*s+p*p),g=i*a+o*c+e*l,v=h&&-u(g)/h,d=Math.atan2(h,g);_n+=v*f,Hn+=v*s,Qn+=v*p,Gn+=d,Zn+=d*(i+(i=a)),Tn+=d*(o+(o=c)),Jn+=d*(e+(e=l)),en(i,o,e)}var t,r,i,o,e;tt.point=function(a,u){t=a,r=u,tt.point=n,a*=Pn;var c=Math.cos(u*=Pn);i=c*Math.cos(a),o=c*Math.sin(a),e=Math.sin(u),en(i,o,e)},tt.lineEnd=function(){n(t,r),tt.lineEnd=un,tt.point=on}}function ln(){function n(n,t){Kn+=o*n-i*t,i=n,o=t}var t,r,i,o;rt.point=function(e,a){rt.point=n,t=i=e,r=o=a},rt.lineEnd=function(){n(t,r)}}function fn(n,t){Yn>n&&(Yn=n),n>Xn&&(Xn=n),$n>t&&($n=t),t>nt&&(nt=t)}function sn(){function n(n,t){a.push("M",n,",",t,e)}function t(n,t){a.push("M",n,",",t),u.point=r}function r(n,t){a.push("L",n,",",t)}function i(){u.point=n}function o(){a.push("Z")}var e=pn(4.5),a=[],u={point:n,lineStart:function(){u.point=t},lineEnd:i,polygonStart:function(){u.lineEnd=o},polygonEnd:function(){u.lineEnd=i,u.point=n},pointRadius:function(n){return e=pn(n),u},result:function(){if(a.length){var n=a.join("");return a=[],n}}};return u}function pn(n){return"m0,"+n+"a"+n+","+n+" 0 1,1 0,"+-2*n+"a"+n+","+n+" 0 1,1 0,"+2*n+"z"}function hn(n,t){Un+=n,Dn+=t,++Wn}function gn(){function n(n,i){var o=n-t,e=i-r,a=Math.sqrt(o*o+e*e);Zn+=a*(t+n)/2,Tn+=a*(r+i)/2,Jn+=a,hn(t=n,r=i)}var t,r;ot.point=function(i,o){ot.point=n,hn(t=i,r=o)}}function vn(){ot.point=hn}function dn(){function n(n,t){var r=n-i,e=t-o,a=Math.sqrt(r*r+e*e);Zn+=a*(i+n)/2,Tn+=a*(o+t)/2,Jn+=a,a=o*n-i*t,_n+=a*(i+n),Hn+=a*(o+t),Qn+=3*a,hn(i=n,o=t)}var t,r,i,o;ot.point=function(e,a){ot.point=n,hn(t=i=e,r=o=a)},ot.lineEnd=function(){n(t,r)}}function Mn(n){function t(t,r){n.moveTo(t+a,r),n.arc(t,r,a,0,wn)}function r(t,r){n.moveTo(t,r),u.point=i}function i(t,r){n.lineTo(t,r)}function o(){u.point=t}function e(){n.closePath()}var a=4.5,u={point:t,lineStart:function(){u.point=r},lineEnd:o,polygonStart:function(){u.lineEnd=e},polygonEnd:function(){u.lineEnd=o,u.point=t},pointRadius:function(n){return a=n,u},result:s};return u}function yn(n){var t=V(function(t,r){return n([t*jn,r*jn])});return function(n){return nn(t(n))}}function mn(n,t){return[n,Math.log(Math.tan(Nn/4+t/2))]}function En(n){var t,r=$(n),i=r.scale,o=r.translate,e=r.clipExtent;return r.scale=function(){var n=i.apply(r,arguments);return n===r?t?r.clipExtent(null):r:n},r.translate=function(){var n=o.apply(r,arguments);return n===r?t?r.clipExtent(null):r:n},r.clipExtent=function(n){var a=e.apply(r,arguments);if(a===r){if(t=null==n){var u=Nn*i(),c=o();e([[c[0]-u,c[1]-u],[c[0]+u,c[1]+u]])}}else t&&(a=null);return a},r.clipExtent(null)}var Sn={version:"3.5.5"},xn=1e-6,bn=xn*xn,Nn=Math.PI,wn=2*Nn,qn=Nn/2,Pn=Nn/180,jn=180/Nn;Sn.geo={},Sn.rebind=function(n,t){for(var r,i=1,o=arguments.length;++i<o;)n[r=arguments[i]]=l(n,t,t[r]);return n};var An=Math.abs;Sn.merge=function(n){for(var t,r,i,o=n.length,e=-1,a=0;++e<o;)a+=n[e].length;for(r=new Array(a);--o>=0;)for(i=n[o],t=i.length;--t>=0;)r[--a]=i[t];return r};var Rn=M(f,S,b,[-Nn,-Nn/2]);(Sn.geo.equirectangular=function(){return $(I)}).raw=I.invert=I,Sn.geo.rotation=function(n){function t(t){return t=n(t[0]*Pn,t[1]*Pn),t[0]*=jn,t[1]*=jn,t}return n=k(n[0]%360*Pn,n[1]*Pn,n.length>2?n[2]*Pn:0),t.invert=function(t){return t=n.invert(t[0]*Pn,t[1]*Pn),t[0]*=jn,t[1]*=jn,t},t},O.invert=I,Sn.geo.circle=function(){function n(){var n="function"==typeof i?i.apply(this,arguments):i,t=k(-n[0]*Pn,-n[1]*Pn,0).invert,o=[];return r(null,null,1,{point:function(n,r){o.push(n=t(n,r)),n[0]*=jn,n[1]*=jn}}),{type:"Polygon",coordinates:[o]}}var t,r,i=[0,0],o=6;return n.origin=function(t){return arguments.length?(i=t,n):i},n.angle=function(i){return arguments.length?(r=L((t=+i)*Pn,o*Pn),n):t},n.precision=function(i){return arguments.length?(r=L(t*Pn,(o=+i)*Pn),n):o},n.angle(90)},G.prototype={s:0,t:0,add:function(n){U(n,this.t,In),U(In.s,this.s,this),this.s?this.t+=In.t:this.s=In.t},reset:function(){this.s=this.t=0},valueOf:function(){return this.s}};var In=new G;Sn.geo.stream=function(n,t){n&&On.hasOwnProperty(n.type)?On[n.type](n,t):D(n,t)};var On={Feature:function(n,t){D(n.geometry,t)},FeatureCollection:function(n,t){for(var r=n.features,i=-1,o=r.length;++i<o;)D(r[i].geometry,t)}},kn={Sphere:function(n,t){t.sphere()},Point:function(n,t){n=n.coordinates,t.point(n[0],n[1],n[2])},MultiPoint:function(n,t){for(var r=n.coordinates,i=-1,o=r.length;++i<o;)n=r[i],t.point(n[0],n[1],n[2])},LineString:function(n,t){W(n.coordinates,t,0)},MultiLineString:function(n,t){for(var r=n.coordinates,i=-1,o=r.length;++i<o;)W(r[i],t,0)},Polygon:function(n,t){Z(n.coordinates,t)},MultiPolygon:function(n,t){for(var r=n.coordinates,i=-1,o=r.length;++i<o;)Z(r[i],t)},GeometryCollection:function(n,t){for(var r=n.geometries,i=-1,o=r.length;++i<o;)D(r[i],t)}};Sn.geo.area=function(n){return zn=0,Sn.geo.stream(n,Bn),zn};var zn,Cn=new G,Bn={sphere:function(){zn+=4*Nn},point:s,lineStart:s,lineEnd:s,polygonStart:function(){Cn.reset(),Bn.lineStart=T},polygonEnd:function(){var n=2*Cn;zn+=0>n?4*Nn+n:n,Bn.lineStart=Bn.lineEnd=Bn.point=s}},Ln=1e9;Sn.geo.clipExtent=function(){var n,t,r,i,o,e,a={stream:function(n){return o&&(o.valid=!1),o=e(n),o.valid=!0,o},extent:function(u){return arguments.length?(e=Q(n=+u[0][0],t=+u[0][1],r=+u[1][0],i=+u[1][1]),o&&(o.valid=!1,o=null),a):[[n,t],[r,i]]}};return a.extent([[0,0],[960,500]])};[].slice;Sn.geo.transform=function(n){return{stream:function(t){var r=new K(t);for(var i in n)r[i]=n[i];return r}}},K.prototype={point:function(n,t){this.stream.point(n,t)},sphere:function(){this.stream.sphere()},lineStart:function(){this.stream.lineStart()},lineEnd:function(){this.stream.lineEnd()},polygonStart:function(){this.stream.polygonStart()},polygonEnd:function(){this.stream.polygonEnd()}},Sn.geo.projection=$,Sn.geo.projectionMutator=X,(Sn.geo.conicEqualArea=function(){return tn(rn)}).raw=rn,Sn.geo.albers=function(){return Sn.geo.conicEqualArea().rotate([96,0]).center([-.6,38.7]).parallels([29.5,45.5]).scale(1070)},Sn.geo.albersUsa=function(){function n(n){var e=n[0],a=n[1];return t=null,r(e,a),t||(i(e,a),t)||o(e,a),t}var t,r,i,o,e=Sn.geo.albers(),a=Sn.geo.conicEqualArea().rotate([154,0]).center([-2,58.5]).parallels([55,65]),u=Sn.geo.conicEqualArea().rotate([157,0]).center([-3,19.9]).parallels([8,18]),c={point:function(n,r){t=[n,r]}};return n.invert=function(n){var t=e.scale(),r=e.translate(),i=(n[0]-r[0])/t,o=(n[1]-r[1])/t;return(o>=.12&&.234>o&&i>=-.425&&-.214>i?a:o>=.166&&.234>o&&i>=-.214&&-.115>i?u:e).invert(n)},n.stream=function(n){var t=e.stream(n),r=a.stream(n),i=u.stream(n);return{point:function(n,o){t.point(n,o),r.point(n,o),i.point(n,o)},sphere:function(){t.sphere(),r.sphere(),i.sphere()},lineStart:function(){t.lineStart(),r.lineStart(),i.lineStart()},lineEnd:function(){t.lineEnd(),r.lineEnd(),i.lineEnd()},polygonStart:function(){t.polygonStart(),r.polygonStart(),i.polygonStart()},polygonEnd:function(){t.polygonEnd(),r.polygonEnd(),i.polygonEnd()}}},n.precision=function(t){return arguments.length?(e.precision(t),a.precision(t),u.precision(t),n):e.precision()},n.scale=function(t){return arguments.length?(e.scale(t),a.scale(.35*t),u.scale(t),n.translate(e.translate())):e.scale()},n.translate=function(t){if(!arguments.length)return e.translate();var l=e.scale(),f=+t[0],s=+t[1];return r=e.translate(t).clipExtent([[f-.455*l,s-.238*l],[f+.455*l,s+.238*l]]).stream(c).point,i=a.translate([f-.307*l,s+.201*l]).clipExtent([[f-.425*l+xn,s+.12*l+xn],[f-.214*l-xn,s+.234*l-xn]]).stream(c).point,o=u.translate([f-.205*l,s+.212*l]).clipExtent([[f-.214*l+xn,s+.166*l+xn],[f-.115*l-xn,s+.234*l-xn]]).stream(c).point,n},n.scale(1070)},Sn.geo.bounds=function(){function n(n,t){E.push(S=[f=n,h=n]),s>t&&(s=t),t>g&&(g=t)}function t(t,r){var i=N([t*Pn,r*Pn]);if(y){var o=q(y,i),e=[o[1],-o[0],0],a=q(e,o);A(a),a=p(a);var c=t-v,l=c>0?1:-1,d=a[0]*jn*l,M=An(c)>180;if(M^(d>l*v&&l*t>d)){var m=a[1]*jn;m>g&&(g=m)}else if(d=(d+360)%360-180,M^(d>l*v&&l*t>d)){var m=-a[1]*jn;s>m&&(s=m)}else s>r&&(s=r),r>g&&(g=r);M?v>t?u(f,t)>u(f,h)&&(h=t):u(t,h)>u(f,h)&&(f=t):h>=f?(f>t&&(f=t),t>h&&(h=t)):t>v?u(f,t)>u(f,h)&&(h=t):u(t,h)>u(f,h)&&(f=t)}else n(t,r);y=i,v=t}function r(){x.point=t}function i(){S[0]=f,S[1]=h,x.point=n,y=null}function o(n,r){if(y){var i=n-v;m+=An(i)>180?i+(i>0?360:-360):i}else d=n,M=r;Bn.point(n,r),t(n,r)}function e(){Bn.lineStart()}function a(){o(d,M),Bn.lineEnd(),An(m)>xn&&(f=-(h=180)),S[0]=f,S[1]=h,y=null}function u(n,t){return(t-=n)<0?t+360:t}function c(n,t){return n[0]-t[0]}function l(n,t){return t[0]<=t[1]?t[0]<=n&&n<=t[1]:n<t[0]||t[1]<n}var f,s,h,g,v,d,M,y,m,E,S,x={point:n,lineStart:r,lineEnd:i,polygonStart:function(){x.point=o,x.lineStart=e,x.lineEnd=a,m=0,Bn.polygonStart()},polygonEnd:function(){Bn.polygonEnd(),x.point=n,x.lineStart=r,x.lineEnd=i,0>Cn?(f=-(h=180),s=-(g=90)):m>xn?g=90:-xn>m&&(s=-90),S[0]=f,S[1]=h}};return function(n){g=h=-(f=s=1/0),E=[],Sn.geo.stream(n,x);var t=E.length;if(t){E.sort(c);for(var r,i=1,o=E[0],e=[o];t>i;++i)r=E[i],l(r[0],o)||l(r[1],o)?(u(o[0],r[1])>u(o[0],o[1])&&(o[1]=r[1]),u(r[0],o[1])>u(o[0],o[1])&&(o[0]=r[0])):e.push(o=r);for(var a,r,p=-(1/0),t=e.length-1,i=0,o=e[t];t>=i;o=r,++i)r=e[i],(a=u(o[1],r[0]))>p&&(p=a,f=r[0],h=o[1])}return E=S=null,f===1/0||s===1/0?[[NaN,NaN],[NaN,NaN]]:[[f,s],[h,g]]}}(),Sn.geo.centroid=function(n){Fn=Gn=Un=Dn=Wn=Zn=Tn=Jn=_n=Hn=Qn=0,Sn.geo.stream(n,tt);var t=_n,r=Hn,i=Qn,o=t*t+r*r+i*i;return bn>o&&(t=Zn,r=Tn,i=Jn,xn>Gn&&(t=Un,r=Dn,i=Wn),o=t*t+r*r+i*i,bn>o)?[NaN,NaN]:[Math.atan2(r,t)*jn,c(i/Math.sqrt(o))*jn]};var Fn,Gn,Un,Dn,Wn,Zn,Tn,Jn,_n,Hn,Qn,Vn,Kn,Yn,$n,Xn,nt,tt={sphere:s,point:on,lineStart:an,lineEnd:un,polygonStart:function(){tt.lineStart=cn},polygonEnd:function(){tt.lineStart=an}},rt={point:s,lineStart:s,lineEnd:s,polygonStart:function(){Kn=0,rt.lineStart=ln},polygonEnd:function(){rt.lineStart=rt.lineEnd=rt.point=s,Vn+=An(Kn/2)}},it={point:fn,lineStart:s,lineEnd:s,polygonStart:s,polygonEnd:s},ot={point:hn,lineStart:gn,lineEnd:vn,polygonStart:function(){ot.lineStart=dn},polygonEnd:function(){ot.point=hn,ot.lineStart=gn,ot.lineEnd=vn}};Sn.geo.path=function(){function n(n){return n&&("function"==typeof c&&a.pointRadius(+c.apply(this,arguments)),u&&u.valid||(u=o(a)),Sn.geo.stream(n,u)),a.result()}function t(){return u=null,n}var r,i,o,a,u,c=4.5;return n.area=function(n){return Vn=0,Sn.geo.stream(n,o(rt)),Vn},n.centroid=function(n){return Un=Dn=Wn=Zn=Tn=Jn=_n=Hn=Qn=0,Sn.geo.stream(n,o(ot)),Qn?[_n/Qn,Hn/Qn]:Jn?[Zn/Jn,Tn/Jn]:Wn?[Un/Wn,Dn/Wn]:[NaN,NaN]},n.bounds=function(n){return Xn=nt=-(Yn=$n=1/0),Sn.geo.stream(n,o(it)),[[Yn,$n],[Xn,nt]]},n.projection=function(n){return arguments.length?(o=(r=n)?n.stream||yn(n):e,t()):r},n.context=function(n){return arguments.length?(a=null==(i=n)?new sn:new Mn(n),"function"!=typeof c&&a.pointRadius(c),t()):i},n.pointRadius=function(t){return arguments.length?(c="function"==typeof t?t:(a.pointRadius(+t),+t),n):c},n.projection(Sn.geo.albersUsa()).context(null)},mn.invert=function(n,t){return[n,2*Math.atan(Math.exp(t))-qn]},(Sn.geo.mercator=function(){return En(mn)}).raw=mn,i=Sn,o="function"==typeof i?i.call(t,r,t,n):i,!(void 0!==o&&(n.exports=o)),this.d3f=Sn}()},function(n,t){function r(n){var t={};for(var r in n)t[r]=o.copy(n[r]);return t}function i(n,t){for(var r,i=n.length,o=i-t;o<--i;)r=n[o],n[o++]=n[i],n[i]=r}var o={};o.copy=function(n){return n instanceof Array?n.map(o.copy):"string"==typeof n||"number"==typeof n?n:r(n)},o.arctans=function(n,t){var r=n/t,i=Math.sqrt(1+r*r),o=t>0?i:-i,e=1/o,a=r*e;return{cos:e,sin:a}},o.object=function(n,t){function r(t,r){r.length&&r.pop();for(var o=n[0>t?~t:t],e=0,a=o.length;a>e;++e)r.push(o[e]);0>t&&i(r,a)}function o(n){for(var t=[],i=0,o=n.length;o>i;++i)r(n[i],t);return t}function e(n){return n.map(o)}function a(n){return n=Object.create(n),n.properties=n.properties,n.coordinates=u[n.type](n.arcs),n.type=n.type,n}var u={LineString:o,MultiLineString:e,Polygon:e,MultiPolygon:function(n){return n.map(e)}};return"GeometryCollection"===t.type?(t=Object.create(t),t.geometries=t.geometries.map(a),t):a(t)},o.properties=function(n){return n.properties||{}},o.transformer=function(n){function t(n){return[n[0]*r+o,n[1]*i+e]}var r=n.scale[0],i=n.scale[1],o=n.translate[0],e=n.translate[1];return t.invert=function(n){return[(n[0]-o)/r,(n[1]-e)/i]},t},n.exports=o},function(n,t){!function(t){function r(n){var t=y[n]={};return s(n.split(/\s+/),function(n){t[n]=!0}),t}var i={},o=Array.prototype,e=Object.prototype,a=e.hasOwnProperty,u=e.toString,c=o.forEach,l=o.indexOf,f=o.slice,s=function(n,t,r){var o,e,u;if(n)if(c&&n.forEach===c)n.forEach(t,r);else if(n.length===+n.length){for(e=0,u=n.length;u>e;e++)if(e in n&&t.call(r,n[e],e,n)===i)return}else for(o in n)if(a.call(n,o)&&t.call(r,n[o],o,n)===i)return},p=function(n){return!!(n&&n.constructor&&n.call&&n.apply)},h=function(n){return s(f.call(arguments,1),function(t){var r;for(r in t)void 0!==t[r]&&(n[r]=t[r])}),n},g=function(n,t,r){var i;if(t){if(l)return l.call(t,n,r);for(i=t.length,r=r?0>r?Math.max(0,i+r):r:0;i>r;r++)if(r in t&&t[r]===n)return r}return-1},v={};s("Boolean Number String Function Array Date RegExp Object".split(" "),function(n,t){v["[object "+n+"]"]=n.toLowerCase()});var d=function(n){return null==n?String(n):v[u.call(n)]||"object"},M={},y={};M.Callbacks=function(n){n="string"==typeof n?y[n]||r(n):h({},n);var t,i,o,e,a,u,c=[],l=!n.once&&[],f=function(r){for(t=n.memory&&r,i=!0,u=e||0,e=0,a=c.length,o=!0;c&&a>u;u++)if(c[u].apply(r[0],r[1])===!1&&n.stopOnFalse){t=!1;break}o=!1,c&&(l?l.length&&f(l.shift()):t?c=[]:p.disable())},p={add:function(){if(c){var r=c.length;!function i(t){s(t,function(t){var r=d(t);"function"===r?n.unique&&p.has(t)||c.push(t):t&&t.length&&"string"!==r&&i(t)})}(arguments),o?a=c.length:t&&(e=r,f(t))}return this},remove:function(){return c&&s(arguments,function(n){for(var t;(t=g(n,c,t))>-1;)c.splice(t,1),o&&(a>=t&&a--,u>=t&&u--)}),this},has:function(n){return g(n,c)>-1},empty:function(){return c=[],this},disable:function(){return c=l=t=void 0,this},disabled:function(){return!c},lock:function(){return l=void 0,t||p.disable(),this},locked:function(){return!l},fireWith:function(n,t){return t=t||[],t=[n,t.slice?t.slice():t],!c||i&&!l||(o?l.push(t):f(t)),this},fire:function(){return p.fireWith(this,arguments),this},fired:function(){return!!i}};return p},M.Deferred=function(n){var t=[["resolve","done",M.Callbacks("once memory"),"resolved"],["reject","fail",M.Callbacks("once memory"),"rejected"],["notify","progress",M.Callbacks("memory")]],r="pending",i={state:function(){return r},always:function(){return o.done(arguments).fail(arguments),this},then:function(){var n=arguments;return M.Deferred(function(r){s(t,function(t,i){var e=t[0],a=n[i];o[t[1]](p(a)?function(){var n;try{n=a.apply(this,arguments)}catch(t){return void r.reject(t)}n&&p(n.promise)?n.promise().done(r.resolve).fail(r.reject).progress(r.notify):r["notify"!==e?"resolveWith":e+"With"](this===o?r:this,[n])}:r[e])}),n=null}).promise()},promise:function(n){return null!=n?h(n,i):i}},o={};return i.pipe=i.then,s(t,function(n,e){var a=n[2],u=n[3];i[n[1]]=a.add,u&&a.add(function(){r=u},t[1^e][2].disable,t[2][2].lock),o[n[0]]=a.fire,o[n[0]+"With"]=a.fireWith}),i.promise(o),n&&n.call(o,o),o},M.when=function(n){var t,r,i,o=0,e="array"===d(n)&&1===arguments.length?n:f.call(arguments),a=e.length,u=1!==a||n&&p(n.promise)?a:0,c=1===u?n:M.Deferred(),l=function(n,r,i){return function(o){r[n]=this,i[n]=arguments.length>1?f.call(arguments):o,i===t?c.notifyWith(r,i):--u||c.resolveWith(r,i)}};if(a>1)for(t=new Array(a),r=new Array(a),i=new Array(a);a>o;o++)e[o]&&p(e[o].promise)?e[o].promise().done(l(o,i,e)).fail(c.reject).progress(l(o,r,t)):--u;return u||c.resolveWith(i,e),c.promise()},"undefined"!=typeof n&&n.exports?n.exports=M:"undefined"!=typeof t._?t._.mixin(M):t._=M}(this)}])});